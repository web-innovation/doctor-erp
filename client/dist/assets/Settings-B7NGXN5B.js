import{ag as C,I as se,r as g,b as Q,p as B,z as x,j as e,n as ve,o as we,i as Ue,aE as Ye,aF as Je,aG as Xe,aH as X,aI as Z,c as E,d as F,a6 as Se,af as G,aJ as Ze,as as es,a7 as te,h as Pe,W as ss,D as S,a0 as ee,a as ts,g as ye,aK as rs,s as as,am as ns,a5 as is,aL as ls,k as os}from"./index-ae8E7MVz.js";import{u as k}from"./useMutation-BTnhOH6c.js";import{n as me,a as ds,r as cs,B as ms,P as us,b as je}from"./printTemplates-BhPuBDug.js";const V={getEmailConfig:async()=>{var t;return((t=(await C.get("/notifications/email/config")).data)==null?void 0:t.data)||null},saveEmailConfig:async o=>(await C.post("/notifications/email/config",o)).data,testEmailConfig:async()=>(await C.post("/notifications/email/test")).data,sendAppointmentReminder:async o=>(await C.post(`/notifications/appointment-reminder/${o}`)).data,sendPrescriptionEmail:async o=>(await C.post(`/notifications/prescription/${o}`)).data,sendBillEmail:async o=>(await C.post(`/notifications/bill/${o}`)).data,sendBulkReminders:async(o=24)=>(await C.post("/notifications/bulk-reminders",{hours:o})).data,getEmailLogs:async(o={})=>{var f;return((f=(await C.get("/notifications/email/logs",{params:o})).data)==null?void 0:f.data)||{logs:[],pagination:{}}},getOtpTemplate:async()=>{var t;return((t=(await C.get("/notifications/email/otp-template")).data)==null?void 0:t.data)||null},saveOtpTemplate:async o=>(await C.post("/notifications/email/otp-template",o)).data,getWhatsAppConfig:async()=>{var t;return((t=(await C.get("/notifications/whatsapp/config")).data)==null?void 0:t.data)||null},saveWhatsAppConfig:async o=>(await C.post("/notifications/whatsapp/config",o)).data,testWhatsAppConfig:async o=>(await C.post("/notifications/whatsapp/test",{phoneNumber:o})).data},xs=[{id:"gmail-app-password",name:"Gmail (App Password)",icon:Ue,color:"text-green-500",recommended:!0},{id:"gmail",name:"Gmail (OAuth2)",icon:Ye,color:"text-red-500"},{id:"outlook",name:"Outlook (OAuth2)",icon:Je,color:"text-blue-500"},{id:"smtp",name:"SMTP (Custom)",icon:Xe,color:"text-gray-500"}];function ps(){const o=se(),[t,f]=g.useState("gmail-app-password"),[p,q]=g.useState({}),[N,y]=g.useState(!1),{register:c,handleSubmit:I,reset:W,setValue:m,watch:v,formState:{errors:n}}=Q({defaultValues:{provider:"gmail-app-password",userEmail:"",fromName:"Docsy",appPassword:"",clientId:"",clientSecret:"",refreshToken:"",tenantId:"",host:"",port:587,user:"",password:"",secure:!1}});v("provider");const{data:r,isLoading:T}=B({queryKey:["emailConfig"],queryFn:()=>V.getEmailConfig()});g.useEffect(()=>{r!=null&&r.configured&&(f(r.provider),m("provider",r.provider),m("userEmail",r.userEmail||""),m("fromName",r.fromName||"Docsy"))},[r,m]);const w=k({mutationFn:V.saveEmailConfig,onSuccess:()=>{x.success("Email configuration saved successfully"),o.invalidateQueries(["emailConfig"])},onError:a=>{var u,R;x.error(((R=(u=a.response)==null?void 0:u.data)==null?void 0:R.message)||"Failed to save configuration")}}),b=k({mutationFn:V.testEmailConfig,onSuccess:a=>{x.success(a.message||"Test email sent successfully")},onError:a=>{var u,R;x.error(((R=(u=a.response)==null?void 0:u.data)==null?void 0:R.message)||"Failed to send test email")}}),{data:P,isLoading:L}=B({queryKey:["otpTemplate"],queryFn:()=>V.getOtpTemplate()}),[M,l]=g.useState(""),[h,A]=g.useState([]);g.useEffect(()=>{typeof P<"u"&&(P&&typeof P=="object"?(l(P.template||""),A(P.placeholders||[])):(l(P||""),A([])))},[P]);const O=k({mutationFn:a=>V.saveOtpTemplate(a),onSuccess:()=>{x.success("OTP email template saved"),o.invalidateQueries(["otpTemplate"])},onError:a=>{var u,R;x.error(((R=(u=a.response)==null?void 0:u.data)==null?void 0:R.message)||"Failed to save template")}}),_=()=>{O.mutate({template:M})},xe=a=>{const u={provider:t,userEmail:a.userEmail,fromName:a.fromName};t==="gmail-app-password"?u.appPassword=a.appPassword:t==="gmail"?(u.clientId=a.clientId,u.clientSecret=a.clientSecret,u.refreshToken=a.refreshToken):t==="outlook"?(u.clientId=a.clientId,u.clientSecret=a.clientSecret,u.refreshToken=a.refreshToken,u.tenantId=a.tenantId):t==="smtp"&&(u.host=a.host,u.port=parseInt(a.port),u.user=a.user,u.password=a.password,u.secure=a.secure),w.mutate(u)},pe=()=>{y(!0),b.mutate(void 0,{onSettled:()=>y(!1)})},D=a=>{q(u=>({...u,[a]:!u[a]}))};return T?e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ve,{className:"text-sky-500"}),"Email Notifications"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Configure OAuth2 email for appointment reminders, prescriptions, and bills"})]}),(r==null?void 0:r.configured)&&e.jsxs("span",{className:"flex items-center gap-1 text-sm text-green-600 bg-green-50 px-3 py-1 rounded-full",children:[e.jsx(we,{})," Configured"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:xs.map(a=>e.jsxs("button",{type:"button",onClick:()=>{f(a.id),m("provider",a.id)},className:`p-4 rounded-lg border-2 transition-all relative ${t===a.id?"border-sky-500 bg-sky-50":"border-gray-200 hover:border-gray-300"}`,children:[a.recommended&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-0.5 rounded-full",children:"Easy"}),e.jsx(a.icon,{className:`text-2xl mx-auto ${a.color}`}),e.jsx("p",{className:"text-sm font-medium mt-2",children:a.name})]},a.id))}),e.jsxs("form",{onSubmit:I(xe),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",...c("userEmail",{required:"Email is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"your-email@gmail.com"}),n.userEmail&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.userEmail.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",...c("fromName"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Docsy"})]})]}),t==="gmail-app-password"&&e.jsxs("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Simple setup - just need Gmail App Password"}),e.jsxs("a",{href:"https://myaccount.google.com/apppasswords",target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline flex items-center gap-1",children:["Get App Password ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{className:"bg-green-100 p-3 rounded-lg text-sm text-green-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"How to get App Password:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Enable 2-Factor Authentication on your Google Account"}),e.jsxs("li",{children:["Go to ",e.jsx("a",{href:"https://myaccount.google.com/apppasswords",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"myaccount.google.com/apppasswords"})]}),e.jsx("li",{children:'Select "Mail" and your device, click Generate'}),e.jsx("li",{children:"Copy the 16-character password (no spaces needed)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["App Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.appPassword?"text":"password",...c("appPassword",{required:t==="gmail-app-password"&&"App Password is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxx xxxx xxxx xxxx"}),e.jsx("button",{type:"button",onClick:()=>D("appPassword"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.appPassword?e.jsx(E,{}):e.jsx(F,{})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"16-character password from Google App Passwords"})]})]}),t==="gmail"&&e.jsxs("div",{className:"space-y-4 p-4 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Requires Google Cloud Console OAuth2 credentials"}),e.jsxs("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:underline flex items-center gap-1",children:["Get Credentials ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("clientId",{required:t==="gmail"&&"Client ID is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxx.apps.googleusercontent.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.clientSecret?"text":"password",...c("clientSecret",{required:t==="gmail"&&"Client Secret is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"GOCSPX-xxxx"}),e.jsx("button",{type:"button",onClick:()=>D("clientSecret"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.clientSecret?e.jsx(E,{}):e.jsx(F,{})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Refresh Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.refreshToken?"text":"password",...c("refreshToken",{required:t==="gmail"&&"Refresh Token is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"1//xxxx"}),e.jsx("button",{type:"button",onClick:()=>D("refreshToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.refreshToken?e.jsx(E,{}):e.jsx(F,{})})]})]})]}),t==="outlook"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Requires Azure AD App Registration"}),e.jsxs("a",{href:"https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["Get Credentials ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("clientId",{required:t==="outlook"&&"Client ID is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tenant ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("tenantId",{required:t==="outlook"&&"Tenant ID is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.clientSecret?"text":"password",...c("clientSecret",{required:t==="outlook"&&"Client Secret is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxx~xxxx"}),e.jsx("button",{type:"button",onClick:()=>D("clientSecret"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.clientSecret?e.jsx(E,{}):e.jsx(F,{})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Refresh Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.refreshToken?"text":"password",...c("refreshToken",{required:t==="outlook"&&"Refresh Token is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"M.xxxx"}),e.jsx("button",{type:"button",onClick:()=>D("refreshToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.refreshToken?e.jsx(E,{}):e.jsx(F,{})})]})]})]}),t==="smtp"&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Use any SMTP server (AWS SES, SendGrid, Mailgun, etc.)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["SMTP Host ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("host",{required:t==="smtp"&&"Host is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"smtp.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),e.jsx("input",{type:"number",...c("port"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"587"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("user",{required:t==="smtp"&&"Username is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"your-smtp-user"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.password?"text":"password",...c("password",{required:t==="smtp"&&"Password is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"your-smtp-password"}),e.jsx("button",{type:"button",onClick:()=>D("password"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.password?e.jsx(E,{}):e.jsx(F,{})})]})]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...c("secure"),className:"w-4 h-4 text-sky-500 rounded focus:ring-sky-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Use TLS/SSL (port 465)"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:pe,disabled:N||!(r!=null&&r.configured),className:"flex items-center gap-2 px-4 py-2 text-sky-600 bg-sky-50 rounded-lg hover:bg-sky-100 disabled:opacity-50 disabled:cursor-not-allowed",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-sky-500 border-t-transparent rounded-full animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{})," Send Test Email"]})}),e.jsx("button",{type:"submit",disabled:w.isPending,className:"flex items-center gap-2 px-6 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50",children:w.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{})," Save Configuration"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"OTP Email Template"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Customize the HTML template used for email OTPs. Use ",e.jsx("span",{className:"font-mono",children:"{{code}}"})," and ",e.jsx("span",{className:"font-mono",children:"{{expiryMinutes}}"})," as placeholders."]})]})}),e.jsx("div",{className:"mt-4",children:e.jsx("textarea",{value:M,onChange:a=>l(a.target.value),className:"w-full h-48 p-3 border border-gray-200 rounded-lg font-sans",placeholder:"<p>Your OTP is <strong>{{code}}</strong></p>"})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{type:"button",onClick:_,disabled:O==null?void 0:O.isLoading,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-sky-600 text-white rounded-lg hover:bg-sky-700 disabled:opacity-50",children:[e.jsx(G,{})," ",O!=null&&O.isLoading?"Saving...":"Save Template"]})})]}),(h==null?void 0:h.length)>0&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium",children:"Available placeholders:"}),e.jsx("ul",{className:"list-disc list-inside",children:h.map(a=>e.jsx("li",{className:"font-mono",children:a},a))})]})]})}function Te(o){return Ze({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 0C5.381-.008.008 5.352 0 11.971V12c0 6.64 5.359 12 12 12 6.64 0 12-5.36 12-12 0-6.641-5.36-12-12-12zm0 20.801c-4.846.015-8.786-3.904-8.801-8.75V12c-.014-4.846 3.904-8.786 8.75-8.801H12c4.847-.014 8.786 3.904 8.801 8.75V12c.015 4.847-3.904 8.786-8.75 8.801H12zm5.44-11.76c0 1.359-1.12 2.479-2.481 2.479-1.366-.007-2.472-1.113-2.479-2.479 0-1.361 1.12-2.481 2.479-2.481 1.361 0 2.481 1.12 2.481 2.481zm0 5.919c0 1.36-1.12 2.48-2.481 2.48-1.367-.008-2.473-1.114-2.479-2.48 0-1.359 1.12-2.479 2.479-2.479 1.361-.001 2.481 1.12 2.481 2.479zm-5.919 0c0 1.36-1.12 2.48-2.479 2.48-1.368-.007-2.475-1.113-2.481-2.48 0-1.359 1.12-2.479 2.481-2.479 1.358-.001 2.479 1.12 2.479 2.479zm0-5.919c0 1.359-1.12 2.479-2.479 2.479-1.367-.007-2.475-1.112-2.481-2.479 0-1.361 1.12-2.481 2.481-2.481 1.358 0 2.479 1.12 2.479 2.481z"},child:[]}]})(o)}const gs=[{id:"manual",name:"Manual (wa.me links)",icon:te,color:"text-green-500",description:"Opens WhatsApp Web for staff to send manually",recommended:!0},{id:"twilio",name:"Twilio WhatsApp",icon:Te,color:"text-red-500",description:"Automated sending via Twilio API"},{id:"whatsapp-business",name:"WhatsApp Business API",icon:Pe,color:"text-green-600",description:"Official WhatsApp Business Cloud API"}];function hs(){const o=se(),[t,f]=g.useState("manual"),[p,q]=g.useState({}),[N,y]=g.useState(!1),{register:c,handleSubmit:I,reset:W,setValue:m,watch:v,formState:{errors:n}}=Q({defaultValues:{provider:"manual",clinicWhatsAppNumber:"",clinicWhatsAppName:"",twilioAccountSid:"",twilioAuthToken:"",twilioWhatsAppNumber:"",wabAccessToken:"",wabPhoneNumberId:"",wabBusinessId:""}});v("provider");const{data:r,isLoading:T}=B({queryKey:["whatsappConfig"],queryFn:()=>V.getWhatsAppConfig()});g.useEffect(()=>{r!=null&&r.configured&&(f(r.provider),m("provider",r.provider),m("clinicWhatsAppNumber",r.clinicWhatsAppNumber||""),m("clinicWhatsAppName",r.clinicWhatsAppName||""))},[r,m]);const w=k({mutationFn:V.saveWhatsAppConfig,onSuccess:()=>{x.success("WhatsApp configuration saved successfully"),o.invalidateQueries(["whatsappConfig"])},onError:l=>{var h,A;x.error(((A=(h=l.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to save configuration")}}),b=k({mutationFn:V.testWhatsAppConfig,onSuccess:l=>{l.url?(window.open(l.url,"_blank"),x.success("WhatsApp Web opened. Send the test message to verify.")):x.success(l.message||"Test message sent successfully")},onError:l=>{var h,A;x.error(((A=(h=l.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to send test message")}}),P=l=>{const h={provider:t,clinicWhatsAppNumber:l.clinicWhatsAppNumber,clinicWhatsAppName:l.clinicWhatsAppName};t==="twilio"?(h.twilioAccountSid=l.twilioAccountSid,h.twilioAuthToken=l.twilioAuthToken,h.twilioWhatsAppNumber=l.twilioWhatsAppNumber):t==="whatsapp-business"&&(h.wabAccessToken=l.wabAccessToken,h.wabPhoneNumberId=l.wabPhoneNumberId,h.wabBusinessId=l.wabBusinessId),w.mutate(h)},L=()=>{y(!0),b.mutate(void 0,{onSettled:()=>y(!1)})},M=l=>{q(h=>({...h,[l]:!h[l]}))};return T?e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"WhatsApp Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Configure WhatsApp messaging for your clinic"})]}),e.jsx("div",{className:"flex items-center gap-2",children:r!=null&&r.configured?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm",children:[e.jsx(we,{}),"Configured"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-sm",children:[e.jsx(es,{}),"Not Configured"]})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(X,{className:"text-blue-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Multi-Clinic WhatsApp Setup"}),e.jsx("p",{children:"Each clinic can have its own WhatsApp number. Messages will appear to patients as coming from your clinic's WhatsApp account."}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-blue-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Manual:"})," Staff sends from clinic's phone with pre-filled message"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Twilio:"})," Automated sending from your Twilio WhatsApp number"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Business API:"})," Official WhatsApp Business for verified business accounts"]})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Provider"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:gs.map(l=>{const h=l.icon;return e.jsxs("button",{type:"button",onClick:()=>{f(l.id),m("provider",l.id)},className:`relative p-4 border-2 rounded-xl text-left transition-all ${t===l.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[l.recommended&&e.jsx("span",{className:"absolute top-2 right-2 text-xs bg-green-500 text-white px-2 py-0.5 rounded-full",children:"Recommended"}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(h,{className:`text-2xl ${l.color}`}),e.jsx("span",{className:"font-medium text-gray-900",children:l.name})]}),e.jsx("p",{className:"text-xs text-gray-500",children:l.description})]},l.id)})})]}),e.jsxs("form",{onSubmit:I(P),className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(te,{className:"text-green-500"}),"Clinic WhatsApp Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic WhatsApp Number *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"tel",...c("clinicWhatsAppNumber",{required:"Phone number is required"}),placeholder:"+91 9876543210",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),n.clinicWhatsAppNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.clinicWhatsAppNumber.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This is the phone number patients will see as the sender"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Name (as shown in WhatsApp)"}),e.jsx("input",{type:"text",...c("clinicWhatsAppName"),placeholder:"City Health Clinic",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your WhatsApp Business profile name"})]})]})]}),t==="twilio"&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(Te,{className:"text-red-500"}),"Twilio Configuration"]}),e.jsxs("a",{href:"https://console.twilio.com",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-red-600 hover:underline flex items-center gap-1",children:["Get credentials ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account SID *"}),e.jsx("input",{type:"text",...c("twilioAccountSid",{required:t==="twilio"?"Account SID is required":!1}),placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auth Token *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.twilioAuthToken?"text":"password",...c("twilioAuthToken",{required:t==="twilio"?"Auth Token is required":!1}),placeholder:"Your Auth Token",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("button",{type:"button",onClick:()=>M("twilioAuthToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.twilioAuthToken?e.jsx(E,{}):e.jsx(F,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Twilio WhatsApp Number *"}),e.jsx("input",{type:"text",...c("twilioWhatsAppNumber",{required:t==="twilio"?"WhatsApp number is required":!1}),placeholder:"+14155238886",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Twilio sandbox number or your registered WhatsApp number"})]})]})]}),t==="whatsapp-business"&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(Pe,{className:"text-green-600"}),"WhatsApp Business API Configuration"]}),e.jsxs("a",{href:"https://developers.facebook.com/docs/whatsapp/cloud-api/get-started",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-600 hover:underline flex items-center gap-1",children:["Setup Guide ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," WhatsApp Business API requires a verified Facebook Business account and approved WhatsApp Business phone number."]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Access Token *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.wabAccessToken?"text":"password",...c("wabAccessToken",{required:t==="whatsapp-business"?"Access Token is required":!1}),placeholder:"Your permanent access token",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("button",{type:"button",onClick:()=>M("wabAccessToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.wabAccessToken?e.jsx(E,{}):e.jsx(F,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number ID *"}),e.jsx("input",{type:"text",...c("wabPhoneNumberId",{required:t==="whatsapp-business"?"Phone Number ID is required":!1}),placeholder:"1234567890123456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Business Account ID"}),e.jsx("input",{type:"text",...c("wabBusinessId"),placeholder:"1234567890123456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]})]}),t==="manual"&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-green-900 flex items-center gap-2 mb-2",children:[e.jsx(te,{className:"text-green-500"}),"How Manual Mode Works"]}),e.jsxs("ol",{className:"text-sm text-green-800 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:'When you click "Send via WhatsApp", a new tab opens with WhatsApp Web'}),e.jsx("li",{children:"The message is pre-filled with prescription/appointment details"}),e.jsx("li",{children:'Staff clicks "Send" in WhatsApp Web to complete sending'}),e.jsx("li",{children:"The message appears to come from your clinic's WhatsApp account (the one logged into WhatsApp Web)"})]}),e.jsxs("p",{className:"text-sm text-green-700 mt-3",children:[e.jsx("strong",{children:"Tip:"})," Keep WhatsApp Web logged in on the clinic's computer with the clinic's WhatsApp Business account."]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:L,disabled:N||!(r!=null&&r.configured),className:"inline-flex items-center gap-2 px-4 py-2 text-green-600 bg-green-50 rounded-lg hover:bg-green-100 transition disabled:opacity-50",children:N?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"○"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{}),"Send Test Message"]})}),e.jsx("button",{type:"submit",disabled:w.isPending,className:"inline-flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:w.isPending?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"○"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{}),"Save Configuration"]})})]})]})]})}const Ne=["DOCTOR","RECEPTIONIST","PHARMACIST","ACCOUNTANT","STAFF","PATIENT"],ue=["dashboard:view","patients:read","patients:create","patients:update","appointments:read","appointments:create","appointments:update","prescriptions:read","prescriptions:create","staff:read","staff:create","staff:update","pharmacy:read","pharmacy:create","billing:read","billing:create","billing:edit","reports:opd","purchases:read","purchases:create","ledger:read","ledger:create","ledger:update","ledger:delete"];ue.push("leaves:read","leaves:create","leaves:update");const bs=["labs:read","labs:create","labs:update","labs:tests"],fs=["agents:read","agents:create","agents:update","commissions:read","commissions:pay"];function ys(){const o=se(),{data:t,isLoading:f,isError:p,error:q,refetch:N}=B({queryKey:["rolePermissions"],queryFn:()=>S.getRolePermissions()}),[y,c]=g.useState(null);g.useEffect(()=>{if(t!=null&&t.data)c(t.data);else if(!f&&!p){const n={};Ne.forEach(r=>{n[r]=ue.slice()}),c(n)}},[t,f,p]);const I=k({mutationFn:S.updateRolePermissions,onSuccess:()=>{o.invalidateQueries({queryKey:["rolePermissions"]}),x.success("Role permissions updated")},onError:n=>{var r,T;x.error(((T=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:T.message)||"Failed to update role permissions")}}),W={"patients:create":["patients:read"],"patients:update":["patients:read"],"appointments:create":["appointments:read"],"appointments:update":["appointments:read"],"prescriptions:create":["prescriptions:read"],"billing:create":["billing:read"],"billing:edit":["billing:read"],"pharmacy:create":["pharmacy:read"],"staff:create":["staff:read"],"staff:update":["staff:read"],"labs:manage":["labs:read"],"labs:create":["labs:read"],"labs:update":["labs:read"],"labs:tests":["labs:read"],"agents:manage":["agents:read"],"agents:create":["agents:read"],"agents:update":["agents:read"],"commissions:pay":["commissions:read"],"ledger:create":["ledger:read"],"ledger:update":["ledger:read"],"ledger:delete":["ledger:read"],"leaves:create":["leaves:read"],"leaves:update":["leaves:read"]},m=Object.keys(W).reduce((n,r)=>(W[r].forEach(T=>{n[T]=n[T]||[],n[T].push(r)}),n),{}),v=(n,r)=>{c(T=>{const w=new Set(T[n]||[]);if(w.has(r)){w.delete(r);const b=[r];for(;b.length;){const P=b.shift(),L=m[P]||[];for(const M of L)w.has(M)&&(w.delete(M),b.push(M))}}else{w.add(r);const b=W[r]||[];for(const P of b)w.add(P)}return{...T,[n]:Array.from(w)}})};return f?e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Role-based Feature Access"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]}):p?e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Role-based Feature Access"}),e.jsxs("p",{className:"text-sm text-red-500 mb-4",children:["Failed to load role permissions: ",(q==null?void 0:q.message)||"Unknown error"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ee,{variant:"secondary",onClick:()=>N(),children:"Retry"}),e.jsx(ee,{variant:"ghost",onClick:()=>{alert("If this persists, ensure the backend migration/role-permissions endpoint is applied and the server is running.")},children:"Help"})]})]}):y?e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Role-based Feature Access"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Grant or revoke feature access per role. Changes affect only this clinic."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Ne.map(n=>e.jsxs("div",{className:"p-4 border rounded",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("strong",{children:n})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"General"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ue.map(r=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(y[n]||[]).includes(r),onChange:()=>v(n,r)}),e.jsx("span",{className:"text-sm",children:r})]},r))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Labs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:bs.map(r=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(y[n]||[]).includes(r),onChange:()=>v(n,r)}),e.jsx("span",{className:"text-sm",children:r})]},r))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agents & Commissions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:fs.map(r=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(y[n]||[]).includes(r),onChange:()=>v(n,r)}),e.jsx("span",{className:"text-sm",children:r})]},r))})]})]},n))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(ee,{variant:"primary",onClick:()=>I.mutate(y),loading:I.isLoading,children:"Save Role Permissions"})})]}):null}const js=["appointments:read","prescriptions:read","billing:read","pharmacy:read"];function Ns(){const o=se(),{data:t,isLoading:f,isError:p,refetch:q}=B({queryKey:["rolePermissions"],queryFn:()=>S.getRolePermissions()}),[N,y]=g.useState([]);g.useEffect(()=>{t&&t.data&&t.data.PATIENT?y(Array.isArray(t.data.PATIENT)?t.data.PATIENT:[]):!f&&!p&&y([])},[t,f,p]);const c=k({mutationFn:m=>S.updateRolePermissions(m),onSuccess:()=>{o.invalidateQueries({queryKey:["rolePermissions"]}),x.success("Mobile access updated")},onError:m=>{var v,n;x.error(((n=(v=m==null?void 0:m.response)==null?void 0:v.data)==null?void 0:n.message)||"Failed to update mobile access")}}),I=m=>{y(v=>{const n=new Set(v||[]);return n.has(m)?n.delete(m):n.add(m),Array.from(n)})},W=()=>{const m=t&&t.data?{...t.data}:{};m.PATIENT=N,c.mutate(m)};return f?e.jsx("div",{className:"p-4",children:"Loading mobile access..."}):p?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-red-600",children:"Failed to load mobile access settings."}),e.jsx("div",{className:"mt-2",children:e.jsx(ee,{variant:"ghost",onClick:()=>q(),children:"Retry"})})]}):e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Mobile App"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Grant mobile (patient) access to select features."}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:js.map(m=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-3 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(N||[]).includes(m),onChange:()=>I(m)}),e.jsx("span",{className:"text-sm",children:m})]},m))}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ee,{variant:"primary",onClick:W,loading:c.isLoading,children:"Save Mobile Access"})})]})}const vs=[{id:"profile",label:"Profile",icon:ye},{id:"clinic",label:"Clinic",icon:rs},{id:"consultation",label:"Consultation Fees",icon:as},{id:"tax",label:"Tax Setup",icon:ns},{id:"print",label:"Print Templates",icon:is},{id:"email",label:"Email",icon:ve},{id:"whatsapp",label:"WhatsApp",icon:te},{id:"preferences",label:"Preferences",icon:ls},{id:"access",label:"Access Management",icon:ye}],ws=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ss=[{id:"todayAppointments",label:"Today's Appointments",enabled:!0},{id:"revenue",label:"Revenue Stats",enabled:!0},{id:"recentPatients",label:"Recent Patients",enabled:!0},{id:"lowStock",label:"Low Stock Alerts",enabled:!0},{id:"pendingBills",label:"Pending Bills",enabled:!0},{id:"upcomingFollowups",label:"Upcoming Follow-ups",enabled:!1}];function Cs(){const o=se(),{user:t,loadUser:f}=ts(),[p,q]=g.useState("profile"),[N,y]=g.useState(!1),[c,I]=g.useState(!1),{register:W,handleSubmit:m,formState:{errors:v}}=Q({defaultValues:{name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||""}}),{register:n,handleSubmit:r,reset:T,watch:w,formState:{errors:b}}=Q(),P=w("newPassword"),{register:L,handleSubmit:M,setValue:l,formState:{errors:h}}=Q(),{register:A,handleSubmit:O,setValue:_}=Q(),[xe,pe]=g.useState(ws.map(s=>({day:s,isOpen:s!=="Sunday",openTime:"09:00",closeTime:"18:00",breakStart:"13:00",breakEnd:"14:00"}))),[D,a]=g.useState(Ss),[u,R]=g.useState({}),[H,$]=g.useState(me({})),[re,ge]=g.useState("bill"),{data:j,isLoading:ke}=B({queryKey:["clinic-settings"],queryFn:()=>S.getClinicSettings()});g.useEffect(()=>{j&&(l("clinicName",j.clinicName||""),l("address",j.address||""),l("phone",j.phone||""),l("email",j.email||""),l("website",j.website||""),l("registrationNo",j.registrationNo||""),l("gstNo",j.gstNo||""))},[j,l]);const{data:K,isLoading:Ae}=B({queryKey:["tax-settings"],queryFn:()=>S.getTaxSettings()});g.useEffect(()=>{K&&(_("consultationGST",K.consultationGST||""),_("pharmacyGST",K.pharmacyGST||""),_("labGST",K.labGST||""),_("otherGST",K.otherGST||""),_("inclusiveTax",K.inclusiveTax||!1))},[K,_]);const{data:U,isLoading:Ce}=B({queryKey:["preferences"],queryFn:()=>S.getPreferences()});g.useEffect(()=>{U!=null&&U.dashboardWidgets&&a(U.dashboardWidgets)},[U]);const{data:z,isLoading:Ee}=B({queryKey:["consultation-fees"],queryFn:()=>S.getConsultationFees()});g.useEffect(()=>{var i;const s=((i=z==null?void 0:z.data)==null?void 0:i.fees)||{};R(s)},[z]);const{data:ae,isLoading:Fe}=B({queryKey:["print-templates"],queryFn:()=>S.getPrintTemplates()});g.useEffect(()=>{ae&&$(me(ae))},[ae]);const ne=k({mutationFn:s=>S.updateProfile(s),onSuccess:async()=>{x.success("Profile updated successfully"),o.invalidateQueries(["user"]),await f()},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update profile")}}),Y=k({mutationFn:s=>S.changePassword(s),onSuccess:()=>{x.success("Password changed successfully"),T()},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to change password")}}),ie=k({mutationFn:s=>S.updateClinicSettings(s),onSuccess:()=>{x.success("Clinic settings updated successfully"),o.invalidateQueries(["clinic-settings"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update clinic settings")}}),le=k({mutationFn:s=>S.updateTaxSettings(s),onSuccess:()=>{x.success("Tax settings updated successfully"),o.invalidateQueries(["tax-settings"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update tax settings")}});k({mutationFn:s=>S.updateWorkingHours(s),onSuccess:()=>{x.success("Working hours updated successfully"),o.invalidateQueries(["working-hours"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update working hours")}});const oe=k({mutationFn:s=>S.updatePreferences(s),onSuccess:()=>{x.success("Preferences updated successfully"),o.invalidateQueries(["preferences"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update preferences")}}),de=k({mutationFn:s=>S.updateConsultationFees(s),onSuccess:()=>{x.success("Consultation fees updated successfully"),o.invalidateQueries(["consultation-fees"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update consultation fees")}}),ce=k({mutationFn:s=>S.updatePrintTemplates(s),onSuccess:()=>{x.success("Print templates updated successfully"),o.invalidateQueries(["print-templates"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update print templates")}}),qe=s=>{ne.mutate(s)},he=s=>{Y.mutate({currentPassword:s.currentPassword,newPassword:s.newPassword})},Ie=s=>{ie.mutate(s)},We=s=>{le.mutate({...s,consultationGST:parseFloat(s.consultationGST)||0,pharmacyGST:parseFloat(s.pharmacyGST)||0,labGST:parseFloat(s.labGST)||0,otherGST:parseFloat(s.otherGST)||0})},Le=s=>{a(i=>i.map(d=>d.id===s?{...d,enabled:!d.enabled}:d))},Me=()=>{oe.mutate({dashboardWidgets:D})},Re=(s,i)=>{R(d=>({...d,[s]:i===""?"":Math.max(0,Number(i))}))},Ge=()=>{const s={};Object.entries(u||{}).forEach(([i,d])=>{const J=Number(d);Number.isFinite(J)&&J>=0&&(s[i]=J)}),de.mutate(s)},Be=()=>{const s=me(H);ce.mutate(s)},be={clinicName:(j==null?void 0:j.clinicName)||"DocClinic Demo",phone:(j==null?void 0:j.phone)||"+91 98765 43210",address:(j==null?void 0:j.address)||"123 Wellness Street, Tricity"},Oe={id:"demo-bill",billNo:"B-01024",createdAt:new Date().toISOString(),paymentStatus:"PENDING",patient:{name:"Ravi Kumar",phone:"+91 90000 11111"},doctor:{name:"Neha Sharma"},items:[{description:"Consultation Fee",quantity:1,unitPrice:500},{description:"CBC Test",quantity:1,unitPrice:350},{description:"Medicine Pack",quantity:2,unitPrice:180}],subtotal:1210,discountAmount:50,taxAmount:139.2,totalAmount:1299.2,paidAmount:500,dueAmount:799.2,notes:"Demo preview data"},De={id:"demo-rx",prescriptionNo:"P-0102",createdAt:new Date().toISOString(),followUpDate:new Date(Date.now()+7*24*60*60*1e3).toISOString(),patient:{name:"Ravi Kumar",patientId:"P-0102",phone:"+91 90000 11111"},doctor:{name:"Neha Sharma"},vitalsSnapshot:{bp:"120/80",pulse:76,temp:98.4,spo2:99,weight:72},diagnosis:["Viral fever","Mild dehydration"],medicines:[{medicineName:"Paracetamol 650",dosage:"1 tab",frequency:"TID",duration:"3 days",timing:"After food"},{medicineName:"ORS",dosage:"200 ml",frequency:"BID",duration:"2 days",timing:"Anytime"}],labTests:[{testName:"CBC",instructions:"Fasting not required"}],clinicalNotes:"Plenty of fluids, rest recommended.",advice:"Review after 3 days if fever persists."},He=re==="bill"?ds(Oe,be,H):cs(De,be,H),fe=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Profile Information"}),e.jsxs("form",{onSubmit:m(qe),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...W("name",{required:"Name is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),v.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:v.name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",...W("email",{required:"Email is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),v.email&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:v.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...W("phone"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:ne.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),ne.isPending?"Saving...":"Save Changes"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:r(he),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",...n("currentPassword",{required:"Current password is required"}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>y(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:N?e.jsx(E,{}):e.jsx(F,{})})]}),b.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.currentPassword.message})]}),e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",...n("newPassword",{required:"New password is required",minLength:{value:8,message:"Password must be at least 8 characters"}}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>I(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(E,{}):e.jsx(F,{})})]}),b.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.newPassword.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",...n("confirmPassword",{required:"Please confirm your password",validate:s=>s===P||"Passwords do not match"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),b.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.confirmPassword.message})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:Y.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),Y.isPending?"Changing...":"Change Password"]})})]})]})]});if((t==null?void 0:t.role)==="STAFF")return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Settings"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:r(he),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",...n("currentPassword",{required:"Current password is required"}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>y(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:N?e.jsx(E,{}):e.jsx(F,{})})]}),b.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.currentPassword.message})]}),e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",...n("newPassword",{required:"New password is required",minLength:{value:8,message:"Password must be at least 8 characters"}}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>I(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(E,{}):e.jsx(F,{})})]}),b.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.newPassword.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",...n("confirmPassword",{required:"Please confirm your password",validate:s=>s===P||"Passwords do not match"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),b.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.confirmPassword.message})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:Y.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),Y.isPending?"Changing...":"Change Password"]})})]})]})]})});const _e=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Clinic Information"}),ke?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("form",{onSubmit:M(Ie),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Clinic Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...L("clinicName",{required:"Clinic name is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter clinic name"}),h.clinicName&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:h.clinicName.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{...L("address"),rows:2,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter full address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...L("phone"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",...L("email"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),e.jsx("input",{type:"url",...L("website"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://www.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Registration Number"}),e.jsx("input",{type:"text",...L("registrationNo"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter registration number"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:ie.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),ie.isPending?"Saving...":"Save Changes"]})})]})]}),Ve=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tax Configuration"}),Ae?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("form",{onSubmit:O(We),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consultation GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...A("consultationGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pharmacy GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...A("pharmacyGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...A("labGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...A("otherGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...A("inclusiveTax"),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Prices are inclusive of tax (Tax will be calculated from the total price)"})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:le.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),le.isPending?"Saving...":"Save Changes"]})})]})]}),Ke=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Dashboard Customization"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Choose which widgets to display on your dashboard"}),Ce?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map(s=>e.jsx("div",{onClick:()=>Le(s.id),className:`p-4 border rounded-lg cursor-pointer transition ${s.enabled?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-medium ${s.enabled?"text-blue-700":"text-gray-700"}`,children:s.label}),e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${s.enabled?"bg-blue-600":"bg-gray-200"}`,children:s.enabled&&e.jsx(os,{className:"text-white text-xs"})})]})},s.id))}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:Me,disabled:oe.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),oe.isPending?"Saving...":"Save Preferences"]})})]})]}),ze=()=>{var i;const s=((i=z==null?void 0:z.data)==null?void 0:i.doctors)||[];return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Doctor Consultation Fees"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Set consultation amount per doctor. These values are used in new bills and auto-bill from prescription."}),Ee?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No doctors found in this clinic."}):e.jsxs("div",{className:"space-y-3",children:[s.map(d=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-center border border-gray-100 rounded-lg p-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:d.name}),d.email&&e.jsx("p",{className:"text-xs text-gray-500",children:d.email})]}),e.jsx("div",{children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:(u==null?void 0:u[d.id])??"",onChange:J=>Re(d.id,J.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"})})]},d.id)),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:Ge,disabled:de.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),de.isPending?"Saving...":"Save Consultation Fees"]})})]})]})},Qe=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Print Templates"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Choose a design for Bill and Prescription print. You can also use custom HTML with placeholders."}),Fe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bill Template"}),e.jsx("select",{value:H.billTemplateId,onChange:s=>$(i=>({...i,billTemplateId:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:ms.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prescription Template"}),e.jsx("select",{value:H.prescriptionTemplateId,onChange:s=>$(i=>({...i,prescriptionTemplateId:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:us.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),H.billTemplateId==="custom"&&e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Bill HTML"}),e.jsx("textarea",{rows:10,value:H.customBillHtml,onChange:s=>$(i=>({...i,customBillHtml:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"<h1>{{clinicName}}</h1><div>Bill {{billNo}}</div><table>{{itemsTableRows}}</table>"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Bill placeholders: ",je.bill.join(", ")]})]}),H.prescriptionTemplateId==="custom"&&e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Prescription HTML"}),e.jsx("textarea",{rows:10,value:H.customPrescriptionHtml,onChange:s=>$(i=>({...i,customPrescriptionHtml:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"<h1>{{clinicName}}</h1><div>Prescription {{prescriptionNo}}</div><table>{{medicinesTableRows}}</table>"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Prescription placeholders: ",je.prescription.join(", ")]})]}),e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Live Preview"}),e.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>ge("bill"),className:`px-3 py-1.5 text-sm ${re==="bill"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"Bill Preview"}),e.jsx("button",{type:"button",onClick:()=>ge("prescription"),className:`px-3 py-1.5 text-sm border-l border-gray-200 ${re==="prescription"?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"Prescription Preview"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Preview uses sample data. Actual print will use real patient, doctor, bill, and prescription data."}),e.jsx("div",{className:"rounded-lg border border-gray-200 overflow-hidden bg-white",children:e.jsx("iframe",{title:"Print template preview",srcDoc:He,className:"w-full h-[640px] bg-white"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Be,disabled:ce.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),ce.isPending?"Saving...":"Save Print Templates"]})})]})]}),$e=()=>{switch(p){case"profile":return fe();case"clinic":return _e();case"consultation":return ze();case"tax":return Ve();case"print":return Qe();case"hours":return renderHoursTab();case"email":return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx(ps,{})});case"whatsapp":return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx(hs,{})});case"preferences":return Ke();case"access":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx(ys,{})}),e.jsx("div",{children:e.jsx(Ns,{})})]});default:return fe()}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage your account and clinic settings"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:"lg:w-64 flex-shrink-0",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:vs.map(s=>e.jsxs("button",{onClick:()=>q(s.id),className:`w-full flex items-center gap-3 px-4 py-3 text-left transition ${p===s.id?"bg-blue-50 text-blue-600 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-50 border-l-4 border-transparent"}`,children:[e.jsx(s.icon,{className:p===s.id?"text-blue-600":"text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.label})]},s.id))})}),e.jsx("div",{className:"flex-1",children:$e()})]})]})})}export{Cs as default};
