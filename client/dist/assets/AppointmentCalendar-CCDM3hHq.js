import{r as g,p as J,j as t,O as K,P as L,Q as P,Y as _,q as z,B as H}from"./index-tZu4QWUW.js";import{a as G}from"./appointmentService-Bp97Ui3g.js";const w={scheduled:"bg-blue-500",confirmed:"bg-indigo-500",completed:"bg-green-500",cancelled:"bg-red-500","no-show":"bg-gray-500"},D={scheduled:"bg-blue-100 border-blue-200",confirmed:"bg-indigo-100 border-indigo-200",completed:"bg-green-100 border-green-200",cancelled:"bg-red-100 border-red-200","no-show":"bg-gray-100 border-gray-200"},Q=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],R=["January","February","March","April","May","June","July","August","September","October","November","December"];function X(){const[l,y]=g.useState("month"),[d,u]=g.useState(new Date),[h,v]=g.useState(null),[M,b]=g.useState(!1),[C,j]=g.useState(""),n=d.getMonth(),i=d.getFullYear();g.useEffect(()=>{const e=String(n+1).padStart(2,"0");j(`${i}-${e}`)},[n,i]);const{data:p,isLoading:k}=J({queryKey:["calendar",n+1,i],queryFn:()=>G.getCalendarData(n+1,i)}),S=(p==null?void 0:p.data)||{},$=g.useMemo(()=>{const e=new Date(i,n,1),s=new Date(i,n+1,0),o=e.getDay(),r=s.getDate(),c=[];for(let a=0;a<o;a++){const m=new Date(i,n,-o+a+1);c.push({date:m,isCurrentMonth:!1,dayNumber:m.getDate()})}for(let a=1;a<=r;a++){const m=new Date(i,n,a);c.push({date:m,isCurrentMonth:!0,dayNumber:a})}const x=42-c.length;for(let a=1;a<=x;a++){const m=new Date(i,n+1,a);c.push({date:m,isCurrentMonth:!1,dayNumber:a})}return c},[n,i]),O=g.useMemo(()=>{if(l!=="week")return[];const e=new Date(d);return e.setDate(d.getDate()-d.getDay()),Array.from({length:7},(s,o)=>{const r=new Date(e);return r.setDate(e.getDate()+o),{date:r,isCurrentMonth:r.getMonth()===n,dayNumber:r.getDate()}})},[d,l,n]),A=l==="week"?O:$,F=()=>{if(l==="month")u(new Date(i,n-1,1));else{const e=new Date(d);e.setDate(d.getDate()-7),u(e)}},T=()=>{if(l==="month")u(new Date(i,n+1,1));else{const e=new Date(d);e.setDate(d.getDate()+7),u(e)}},W=()=>{u(new Date)},Y=e=>{if(j(e),!e||!e.includes("-"))return;const[s,o]=e.split("-"),r=Number(s),c=Number(o);!r||!c||u(new Date(r,c-1,1))},q=e=>e.toISOString().split("T")[0],f=e=>{const s=q(e);return S[s]||[]},B=e=>{v(e.date),b(!0)},E=e=>{if(!e)return"-";const[s,o]=e.split(":"),r=parseInt(s,10),c=r>=12?"PM":"AM";return`${r%12||12}:${o} ${c}`},I=e=>{const s=new Date;return e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear()},N=h?f(h):[];return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Appointment Calendar"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"View and manage appointments on the calendar"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>y("week"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${l==="week"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100 border border-gray-300"}`,children:"Week"}),t.jsx("button",{onClick:()=>y("month"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${l==="month"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100 border border-gray-300"}`,children:"Month"})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:F,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(K,{className:"text-gray-600"})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:l==="month"?`${R[n]} ${i}`:`Week of ${d.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}`}),t.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(L,{className:"text-gray-600"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"month",lang:"en-GB",value:C,onChange:e=>Y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm","aria-label":"Jump to month and year"}),t.jsx("button",{onClick:W,className:"px-4 py-2 text-blue-600 hover:bg-blue-50 rounded-lg font-medium transition-colors",children:"Today"})]})]}),t.jsxs("div",{className:"flex items-center gap-4 px-4 py-3 bg-gray-50 border-b border-gray-100",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),Object.entries(w).map(([e,s])=>t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:`w-3 h-3 rounded-full ${s}`}),t.jsx("span",{className:"text-sm text-gray-600 capitalize",children:e})]},e))]}),t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:Q.map(e=>t.jsx("div",{className:"text-center text-sm font-semibold text-gray-500 py-2",children:e},e))}),k?t.jsx("div",{className:"grid grid-cols-7 gap-1",children:[...Array(l==="week"?7:35)].map((e,s)=>t.jsx("div",{className:"aspect-square p-2 animate-pulse bg-gray-100 rounded-lg"},s))}):t.jsx("div",{className:`grid grid-cols-7 gap-1 ${l==="week"?"":"grid-rows-6"}`,children:A.map((e,s)=>{const o=f(e.date),r=o.length>0,c=I(e.date),x=o.reduce((a,m)=>(a[m.status]=(a[m.status]||0)+1,a),{});return t.jsxs("div",{onClick:()=>B(e),className:`
                        ${l==="week"?"min-h-[150px]":"aspect-square"}
                        p-2 rounded-lg cursor-pointer transition-all border
                        ${e.isCurrentMonth?"bg-white hover:bg-gray-50":"bg-gray-50 text-gray-400"}
                        ${c?"ring-2 ring-blue-500 ring-offset-2":"border-gray-100"}
                        ${r&&e.isCurrentMonth?"hover:shadow-md":""}
                      `,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:`text-sm font-medium ${c?"w-7 h-7 flex items-center justify-center bg-blue-600 text-white rounded-full":""}`,children:e.dayNumber}),r&&e.isCurrentMonth&&t.jsx("span",{className:"text-xs text-gray-500",children:o.length})]}),r&&e.isCurrentMonth&&t.jsxs("div",{className:"space-y-1",children:[Object.entries(x).slice(0,l==="week"?5:3).map(([a,m])=>t.jsxs("div",{className:`text-xs px-1.5 py-0.5 rounded truncate ${D[a]} border`,children:[m," ",a]},a)),Object.keys(x).length>(l==="week"?5:3)&&t.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",Object.keys(x).length-(l==="week"?5:3)," more"]})]})]},s)})})]})]}),t.jsx(P,{isOpen:M,onClose:()=>b(!1),title:h?h.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):"Appointments",size:"lg",children:t.jsx("div",{className:"space-y-3",children:N.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(_,{className:"text-4xl text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No appointments scheduled for this day"})]}):N.map(e=>{var s,o;return t.jsxs("div",{className:`p-4 rounded-lg border ${D[e.status]}`,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm",children:t.jsx(z,{className:"text-gray-400"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:((s=e.patient)==null?void 0:s.name)||"Unknown Patient"}),t.jsx("p",{className:"text-sm text-gray-500",children:e.type||"Consultation"})]})]}),t.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium capitalize ${w[e.status]} text-white`,children:e.status})]}),t.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-gray-600",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(H,{className:"text-gray-400"}),E(e.time)]}),((o=e.patient)==null?void 0:o.phone)&&t.jsx("div",{className:"flex items-center gap-1",children:t.jsx("span",{children:e.patient.phone})})]}),e.reason&&t.jsx("p",{className:"mt-2 text-sm text-gray-600 bg-white/50 p-2 rounded",children:e.reason})]},e.id)})})})]})})}export{X as default};
