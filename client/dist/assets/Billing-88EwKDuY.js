import{u as we,I as Pe,r as m,b as Ce,J as te,p as Se,j as e,L as Ae,y as De,K as Te,M as Fe,N as ke,v as Ie,d as Be,a5 as se,ak as ae,O as $e,P as Oe,Q as ne,z as y}from"./index-DPyX6QYN.js";import{u as re}from"./useMutation-B_vLsH4g.js";import{b as I}from"./billingService-Bf5s0OjV.js";const ie={pending:"bg-yellow-100 text-yellow-800",partial:"bg-blue-100 text-blue-800",paid:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},Re=[{value:"",label:"All Status"},{value:"pending",label:"Pending"},{value:"partial",label:"Partial"},{value:"paid",label:"Paid"},{value:"cancelled",label:"Cancelled"}],oe=[0,5,10,12,18,20,30];function Ge(){var q,z,Q,L,_,V;const de=we(),C=Pe(),[j,le]=m.useState(""),[u,g]=m.useState(1),[S,ce]=m.useState(!1),[o,B]=m.useState({status:"",startDate:"",endDate:""}),[xe,f]=m.useState(!1),[s,p]=m.useState(null),[me,N]=m.useState(!1),[ue,$]=m.useState(null),b=10,{register:v,handleSubmit:pe,reset:A,formState:{errors:w}}=Ce(),ge=te("billing:create",["SUPER_ADMIN","DOCTOR","ACCOUNTANT","PHARMACIST","RECEPTIONIST"]),O=te("billing:edit",["SUPER_ADMIN","DOCTOR","ACCOUNTANT","PHARMACIST","RECEPTIONIST"]),{data:l,isLoading:he}=Se({queryKey:["bills",u,b,j,o],queryFn:()=>I.getBills({page:u,limit:b,search:j,...o}),placeholderData:t=>t}),R=(l==null?void 0:l.data)||[],D=((q=l==null?void 0:l.pagination)==null?void 0:q.totalPages)||1,M=((z=l==null?void 0:l.pagination)==null?void 0:z.total)||0,T=re({mutationFn:({id:t,paymentData:a})=>I.recordPayment(t,a),onSuccess:()=>{y.success("Payment recorded successfully"),C.invalidateQueries(["bills"]),f(!1),p(null),A()},onError:t=>{var a,r;y.error(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to record payment")}}),ye=re({mutationFn:({id:t,payload:a})=>I.updateBill(t,a),onSuccess:()=>{y.success("GST updated"),C.invalidateQueries(["bills"]),s!=null&&s.id&&C.invalidateQueries(["bill",s.id])},onError:t=>{var a,r;y.error(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to update GST")},onSettled:()=>$(null)}),je=t=>{le(t.target.value),g(1)},F=(t,a)=>{B(r=>({...r,[t]:a})),g(1)},fe=()=>{B({status:"",startDate:"",endDate:""}),g(1)},E=t=>{p(t),f(!0)},Ne=t=>{p(t),N(!0)},U=t=>{var d,n,H,K,W,J,Y,X,Z;const a=window.open("","_blank");if(!a){y.error("Please allow popups to print");return}const r=(t.items||[]).map(h=>{var ee;return`
      <tr>
        <td style="padding: 8px; border-bottom: 1px solid #eee;">${h.description}</td>
        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center;">${h.quantity}</td>
        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: right;">₹${(ee=h.unitPrice)==null?void 0:ee.toFixed(2)}</td>
        <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: right;">₹${(h.quantity*h.unitPrice).toFixed(2)}</td>
      </tr>
    `}).join(""),c=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bill - ${t.billNo||t.id}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 15px; margin-bottom: 20px; }
          .header h1 { margin: 0; color: #333; }
          .header p { margin: 5px 0; color: #666; }
          .bill-info { display: flex; justify-content: space-between; margin-bottom: 20px; }
          .patient-info { background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
          th { background: #333; color: white; padding: 10px; text-align: left; }
          .totals { text-align: right; margin-top: 20px; }
          .totals p { margin: 5px 0; }
          .totals .total { font-size: 18px; font-weight: bold; }
          .footer { margin-top: 40px; text-align: center; color: #666; font-size: 12px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Docsy ERP</h1>
          <p>Tax Invoice</p>
        </div>
        
        <div class="bill-info">
          <div>
            <strong>Bill No:</strong> ${t.billNo||t.id.slice(-8).toUpperCase()}<br>
            <strong>Date:</strong> ${k(t.createdAt)}
          </div>
          <div style="text-align: right;">
            <strong>Status:</strong> ${t.paymentStatus||"PENDING"}
          </div>
        </div>
        
        <div class="patient-info">
          <strong>Patient:</strong> ${((d=t.patient)==null?void 0:d.name)||"Unknown"}<br>
          ${(n=t.patient)!=null&&n.phone?`<strong>Phone:</strong> ${t.patient.phone}`:""}
          ${(H=t.doctor)!=null&&H.name?`<br><strong>Doctor:</strong> Dr. ${t.doctor.name}`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Description</th>
              <th style="text-align: center;">Qty</th>
              <th style="text-align: right;">Price</th>
              <th style="text-align: right;">Amount</th>
            </tr>
          </thead>
          <tbody>
            ${r}
          </tbody>
        </table>
        
        <div class="totals">
          <p><strong>Subtotal:</strong> ₹${((K=t.subtotal)==null?void 0:K.toFixed(2))||"0.00"}</p>
          ${t.discountAmount>0?`<p><strong>Discount:</strong> -₹${(W=t.discountAmount)==null?void 0:W.toFixed(2)}</p>`:""}
          ${t.taxAmount>0?`<p><strong>Tax:</strong> ₹${(J=t.taxAmount)==null?void 0:J.toFixed(2)}</p>`:""}
          <p class="total"><strong>Total:</strong> ₹${((Y=t.totalAmount)==null?void 0:Y.toFixed(2))||"0.00"}</p>
          <p><strong>Paid:</strong> ₹${((X=t.paidAmount)==null?void 0:X.toFixed(2))||"0.00"}</p>
          <p><strong>Balance Due:</strong> ₹${((Z=t.dueAmount)==null?void 0:Z.toFixed(2))||"0.00"}</p>
        </div>
        
        <div class="footer">
          <p>Thank you for your visit!</p>
          <p>This is a computer generated invoice.</p>
        </div>
        
        <script>window.onload = function() { window.print(); }<\/script>
      </body>
      </html>
    `;a.document.write(c),a.document.close()},be=t=>{s&&T.mutate({id:s.id,paymentData:{amount:parseFloat(t.amount),method:t.method,reference:t.reference,notes:t.notes}})},k=t=>t?new Date(t).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",i=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(t||0),x=t=>t.dueAmount||0,P=t=>{const a=Number((t==null?void 0:t.subtotal)||0)-Number((t==null?void 0:t.discountAmount)||0),r=Number((t==null?void 0:t.taxAmount)||0);if(a<=0||r<=0)return 0;const c=Math.round(r/a*100*100)/100,d=oe.find(n=>Number(n)===Number(c));return d!==void 0?d:0},ve=(t,a)=>{const r=Number(a||0),c=Number((t==null?void 0:t.discountPercent)||0)>0,d={notes:(t==null?void 0:t.notes)||"",doctorId:(t==null?void 0:t.doctorId)||void 0,type:(t==null?void 0:t.type)||void 0,discountType:c?"PERCENTAGE":"AMOUNT",discount:Number(c?(t==null?void 0:t.discountPercent)||0:(t==null?void 0:t.discountAmount)||0),taxConfig:{gstRate:r},items:((t==null?void 0:t.items)||[]).map(n=>({description:n.description,quantity:Number(n.quantity)||1,unitPrice:Number(n.unitPrice)||0,gstPercent:Number(n.gstPercent)||0,productId:n.productId||null,labId:n.labId||null,labTestId:n.labTestId||null,doctorId:n.doctorId||null}))};$(t.id),ye.mutate({id:t.id,payload:d})},G=o.status||o.startDate||o.endDate;return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Billing"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage invoices and payments"})]}),ge&&e.jsxs(Ae,{to:"/billing/new",className:"inline-flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2.5 rounded-lg font-medium hover:bg-blue-700 transition",children:[e.jsx(De,{}),"New Bill"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:j,onChange:je,placeholder:"Search by bill number or patient name...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition"})]}),e.jsx("select",{value:o.status,onChange:t=>F("status",t.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Re.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsxs("button",{onClick:()=>ce(!S),className:`inline-flex items-center gap-2 px-4 py-2.5 border rounded-lg font-medium transition ${S||G?"border-blue-500 text-blue-600 bg-blue-50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Fe,{}),"Date Filter",(o.startDate||o.endDate)&&e.jsx("span",{className:"bg-blue-600 text-white text-xs px-1.5 py-0.5 rounded-full",children:"1"})]})]}),S&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",lang:"en-GB",value:o.startDate,onChange:t=>F("startDate",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",lang:"en-GB",value:o.endDate,onChange:t=>F("endDate",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:fe,className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 transition",children:[e.jsx(ke,{}),"Clear Filters"]})})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:he?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):R.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[e.jsx(Ie,{className:"text-4xl mb-4"}),e.jsx("p",{className:"font-medium",children:"No bills found"}),e.jsx("p",{className:"text-sm mt-1",children:j||G?"Try adjusting your search or filters":"Create your first bill to get started"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Bill No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"GST"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:R.map(t=>{var a,r,c,d;return e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:t.billNo||t.id.slice(-8).toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600",children:k(t.createdAt)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((a=t.patient)==null?void 0:a.name)||"Unknown Patient"}),((r=t.patient)==null?void 0:r.phone)&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:t.patient.phone})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:i(t.totalAmount)}),t.status!=="paid"&&x(t)>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-0.5",children:["Due: ",i(x(t))]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:O?e.jsx("select",{value:P(t),onChange:n=>ve(t,n.target.value),disabled:ue===t.id,className:"px-2 py-1.5 text-sm border border-gray-300 rounded-lg bg-white disabled:opacity-60",children:oe.map(n=>e.jsxs("option",{value:n,children:[n,"%"]},n))}):e.jsxs("span",{className:"text-sm text-gray-600",children:[P(t),"%"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2.5 py-1 rounded-full text-xs font-medium capitalize ${ie[(c=t.paymentStatus)==null?void 0:c.toLowerCase()]||ie.pending}`,children:((d=t.paymentStatus)==null?void 0:d.toLowerCase())||"pending"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>Ne(t),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"View",children:e.jsx(Be,{})}),e.jsx("button",{onClick:()=>U(t),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition",title:"Print",children:e.jsx(se,{})}),t.status!=="paid"&&t.status!=="cancelled"&&e.jsxs("button",{onClick:()=>E(t),className:"inline-flex items-center gap-1 px-3 py-1.5 bg-green-50 text-green-600 rounded-lg text-sm font-medium hover:bg-green-100 transition",title:"Record Payment",children:[e.jsx(ae,{className:"text-xs"}),"Pay"]})]})})]},t.id)})})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-100",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:(u-1)*b+1})," ","to"," ",e.jsx("span",{className:"font-medium",children:Math.min(u*b,M)})," ","of ",e.jsx("span",{className:"font-medium",children:M})," bills"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(t=>Math.max(1,t-1)),disabled:u===1,className:"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition",children:e.jsx($e,{className:"text-gray-600"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",u," of ",D]}),e.jsx("button",{onClick:()=>g(t=>Math.min(D,t+1)),disabled:u===D,className:"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition",children:e.jsx(Oe,{className:"text-gray-600"})})]})]})]})})]}),e.jsx(ne,{isOpen:xe,onClose:()=>{f(!1),p(null),A()},title:"Record Payment",size:"md",children:s&&e.jsxs("form",{onSubmit:pe(be),className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Bill Number"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.billNo||s.id.slice(-8).toUpperCase()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Balance Due"}),e.jsx("p",{className:"font-medium text-red-600",children:i(x(s))})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Amount (₹) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",step:"0.01",...v("amount",{required:"Amount is required",min:{value:1,message:"Amount must be at least 1"},max:{value:x(s),message:`Amount cannot exceed ${i(x(s))}`}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter amount",defaultValue:x(s)}),w.amount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.amount.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...v("method",{required:"Payment method is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select method"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"netbanking",children:"Net Banking"}),e.jsx("option",{value:"insurance",children:"Insurance"}),e.jsx("option",{value:"other",children:"Other"})]}),w.method&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.method.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference / Transaction ID"}),e.jsx("input",{...v("reference"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reference number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{...v("notes"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Optional payment notes"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:()=>{f(!1),p(null),A()},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:T.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:T.isPending?"Recording...":"Record Payment"})]})]})}),e.jsx(ne,{isOpen:me,onClose:()=>{N(!1),p(null)},title:"Bill Details",size:"lg",children:s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start pb-4 border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Bill Number"}),e.jsx("p",{className:"font-bold text-lg text-gray-900",children:s.billNo||s.id.slice(-8).toUpperCase()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:k(s.createdAt)})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Patient"}),e.jsx("p",{className:"font-medium text-gray-900",children:((Q=s.patient)==null?void 0:Q.name)||"Unknown Patient"}),((L=s.patient)==null?void 0:L.phone)&&e.jsx("p",{className:"text-sm text-gray-600",children:s.patient.phone}),((_=s.doctor)==null?void 0:_.name)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Doctor: Dr. ",s.doctor.name]})]}),s.items&&s.items.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Items"}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-gray-600",children:"Description"}),e.jsx("th",{className:"px-4 py-2 text-center text-gray-600",children:"Qty"}),e.jsx("th",{className:"px-4 py-2 text-right text-gray-600",children:"Price"}),e.jsx("th",{className:"px-4 py-2 text-right text-gray-600",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:s.items.map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-gray-900",children:t.description}),e.jsx("td",{className:"px-4 py-2 text-center text-gray-600",children:t.quantity}),e.jsx("td",{className:"px-4 py-2 text-right text-gray-600",children:i(t.unitPrice)}),e.jsx("td",{className:"px-4 py-2 text-right font-medium text-gray-900",children:i(t.quantity*t.unitPrice)})]},a))})]})})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-4 space-y-2",children:[s.discount>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Discount"}),e.jsxs("span",{className:"text-red-600",children:["-",i(s.discount)]})]}),P(s)>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Tax (",P(s),"%)"]}),e.jsx("span",{className:"text-gray-600",children:i(s.taxAmount||0)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{className:"text-gray-900",children:"Total Amount"}),e.jsx("span",{className:"text-gray-900",children:i(s.totalAmount)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Paid"}),e.jsx("span",{className:"text-green-600",children:i(((V=s.payments)==null?void 0:V.reduce((t,a)=>t+a.amount,0))||0)})]}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{className:"text-gray-700",children:"Balance Due"}),e.jsx("span",{className:x(s)>0?"text-red-600":"text-green-600",children:i(x(s))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>U(s),className:"inline-flex items-center gap-2 px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[e.jsx(se,{}),"Print"]}),O&&e.jsx("button",{onClick:()=>{N(!1),de(`/billing/${s.id}/edit`)},className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Edit"}),s.status!=="paid"&&s.status!=="cancelled"&&e.jsxs("button",{onClick:()=>{N(!1),E(s)},className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[e.jsx(ae,{}),"Record Payment"]})]})]})})]})}export{Ge as default};
