import{ag as A,I as se,r as g,b as Q,p as R,z as x,j as e,n as ye,o as je,i as _e,aE as Ve,aF as ze,aG as Ke,aH as X,aI as Z,c as C,d as E,a6 as Ne,af as G,aJ as Qe,as as Ue,a7 as te,h as ve,W as $e,D as w,a0 as ee,a as Ye,g as he,aK as Je,s as Xe,am as Ze,a5 as es,aL as ss,k as ts}from"./index-DfbFSgDY.js";import{u as T}from"./useMutation-bt9QuOne.js";import{n as ce,B as as,P as rs,b as be}from"./printTemplates-BEyV9waS.js";const _={getEmailConfig:async()=>{var t;return((t=(await A.get("/notifications/email/config")).data)==null?void 0:t.data)||null},saveEmailConfig:async o=>(await A.post("/notifications/email/config",o)).data,testEmailConfig:async()=>(await A.post("/notifications/email/test")).data,sendAppointmentReminder:async o=>(await A.post(`/notifications/appointment-reminder/${o}`)).data,sendPrescriptionEmail:async o=>(await A.post(`/notifications/prescription/${o}`)).data,sendBillEmail:async o=>(await A.post(`/notifications/bill/${o}`)).data,sendBulkReminders:async(o=24)=>(await A.post("/notifications/bulk-reminders",{hours:o})).data,getEmailLogs:async(o={})=>{var f;return((f=(await A.get("/notifications/email/logs",{params:o})).data)==null?void 0:f.data)||{logs:[],pagination:{}}},getOtpTemplate:async()=>{var t;return((t=(await A.get("/notifications/email/otp-template")).data)==null?void 0:t.data)||null},saveOtpTemplate:async o=>(await A.post("/notifications/email/otp-template",o)).data,getWhatsAppConfig:async()=>{var t;return((t=(await A.get("/notifications/whatsapp/config")).data)==null?void 0:t.data)||null},saveWhatsAppConfig:async o=>(await A.post("/notifications/whatsapp/config",o)).data,testWhatsAppConfig:async o=>(await A.post("/notifications/whatsapp/test",{phoneNumber:o})).data},ns=[{id:"gmail-app-password",name:"Gmail (App Password)",icon:_e,color:"text-green-500",recommended:!0},{id:"gmail",name:"Gmail (OAuth2)",icon:Ve,color:"text-red-500"},{id:"outlook",name:"Outlook (OAuth2)",icon:ze,color:"text-blue-500"},{id:"smtp",name:"SMTP (Custom)",icon:Ke,color:"text-gray-500"}];function is(){const o=se(),[t,f]=g.useState("gmail-app-password"),[p,F]=g.useState({}),[j,y]=g.useState(!1),{register:c,handleSubmit:q,reset:I,setValue:m,watch:N,formState:{errors:n}}=Q({defaultValues:{provider:"gmail-app-password",userEmail:"",fromName:"Docsy",appPassword:"",clientId:"",clientSecret:"",refreshToken:"",tenantId:"",host:"",port:587,user:"",password:"",secure:!1}});N("provider");const{data:a,isLoading:P}=R({queryKey:["emailConfig"],queryFn:()=>_.getEmailConfig()});g.useEffect(()=>{a!=null&&a.configured&&(f(a.provider),m("provider",a.provider),m("userEmail",a.userEmail||""),m("fromName",a.fromName||"Docsy"))},[a,m]);const v=T({mutationFn:_.saveEmailConfig,onSuccess:()=>{x.success("Email configuration saved successfully"),o.invalidateQueries(["emailConfig"])},onError:r=>{var u,M;x.error(((M=(u=r.response)==null?void 0:u.data)==null?void 0:M.message)||"Failed to save configuration")}}),b=T({mutationFn:_.testEmailConfig,onSuccess:r=>{x.success(r.message||"Test email sent successfully")},onError:r=>{var u,M;x.error(((M=(u=r.response)==null?void 0:u.data)==null?void 0:M.message)||"Failed to send test email")}}),{data:S,isLoading:W}=R({queryKey:["otpTemplate"],queryFn:()=>_.getOtpTemplate()}),[L,l]=g.useState(""),[h,k]=g.useState([]);g.useEffect(()=>{typeof S<"u"&&(S&&typeof S=="object"?(l(S.template||""),k(S.placeholders||[])):(l(S||""),k([])))},[S]);const O=T({mutationFn:r=>_.saveOtpTemplate(r),onSuccess:()=>{x.success("OTP email template saved"),o.invalidateQueries(["otpTemplate"])},onError:r=>{var u,M;x.error(((M=(u=r.response)==null?void 0:u.data)==null?void 0:M.message)||"Failed to save template")}}),H=()=>{O.mutate({template:L})},ue=r=>{const u={provider:t,userEmail:r.userEmail,fromName:r.fromName};t==="gmail-app-password"?u.appPassword=r.appPassword:t==="gmail"?(u.clientId=r.clientId,u.clientSecret=r.clientSecret,u.refreshToken=r.refreshToken):t==="outlook"?(u.clientId=r.clientId,u.clientSecret=r.clientSecret,u.refreshToken=r.refreshToken,u.tenantId=r.tenantId):t==="smtp"&&(u.host=r.host,u.port=parseInt(r.port),u.user=r.user,u.password=r.password,u.secure=r.secure),v.mutate(u)},xe=()=>{y(!0),b.mutate(void 0,{onSettled:()=>y(!1)})},B=r=>{F(u=>({...u,[r]:!u[r]}))};return P?e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"text-sky-500"}),"Email Notifications"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Configure OAuth2 email for appointment reminders, prescriptions, and bills"})]}),(a==null?void 0:a.configured)&&e.jsxs("span",{className:"flex items-center gap-1 text-sm text-green-600 bg-green-50 px-3 py-1 rounded-full",children:[e.jsx(je,{})," Configured"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:ns.map(r=>e.jsxs("button",{type:"button",onClick:()=>{f(r.id),m("provider",r.id)},className:`p-4 rounded-lg border-2 transition-all relative ${t===r.id?"border-sky-500 bg-sky-50":"border-gray-200 hover:border-gray-300"}`,children:[r.recommended&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-0.5 rounded-full",children:"Easy"}),e.jsx(r.icon,{className:`text-2xl mx-auto ${r.color}`}),e.jsx("p",{className:"text-sm font-medium mt-2",children:r.name})]},r.id))}),e.jsxs("form",{onSubmit:q(ue),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",...c("userEmail",{required:"Email is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"your-email@gmail.com"}),n.userEmail&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.userEmail.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",...c("fromName"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Docsy"})]})]}),t==="gmail-app-password"&&e.jsxs("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Simple setup - just need Gmail App Password"}),e.jsxs("a",{href:"https://myaccount.google.com/apppasswords",target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline flex items-center gap-1",children:["Get App Password ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{className:"bg-green-100 p-3 rounded-lg text-sm text-green-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"How to get App Password:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Enable 2-Factor Authentication on your Google Account"}),e.jsxs("li",{children:["Go to ",e.jsx("a",{href:"https://myaccount.google.com/apppasswords",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"myaccount.google.com/apppasswords"})]}),e.jsx("li",{children:'Select "Mail" and your device, click Generate'}),e.jsx("li",{children:"Copy the 16-character password (no spaces needed)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["App Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.appPassword?"text":"password",...c("appPassword",{required:t==="gmail-app-password"&&"App Password is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxx xxxx xxxx xxxx"}),e.jsx("button",{type:"button",onClick:()=>B("appPassword"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.appPassword?e.jsx(C,{}):e.jsx(E,{})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"16-character password from Google App Passwords"})]})]}),t==="gmail"&&e.jsxs("div",{className:"space-y-4 p-4 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Requires Google Cloud Console OAuth2 credentials"}),e.jsxs("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:underline flex items-center gap-1",children:["Get Credentials ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("clientId",{required:t==="gmail"&&"Client ID is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxx.apps.googleusercontent.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.clientSecret?"text":"password",...c("clientSecret",{required:t==="gmail"&&"Client Secret is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"GOCSPX-xxxx"}),e.jsx("button",{type:"button",onClick:()=>B("clientSecret"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.clientSecret?e.jsx(C,{}):e.jsx(E,{})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Refresh Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.refreshToken?"text":"password",...c("refreshToken",{required:t==="gmail"&&"Refresh Token is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"1//xxxx"}),e.jsx("button",{type:"button",onClick:()=>B("refreshToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.refreshToken?e.jsx(C,{}):e.jsx(E,{})})]})]})]}),t==="outlook"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Requires Azure AD App Registration"}),e.jsxs("a",{href:"https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["Get Credentials ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("clientId",{required:t==="outlook"&&"Client ID is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tenant ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("tenantId",{required:t==="outlook"&&"Tenant ID is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Client Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.clientSecret?"text":"password",...c("clientSecret",{required:t==="outlook"&&"Client Secret is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"xxxx~xxxx"}),e.jsx("button",{type:"button",onClick:()=>B("clientSecret"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.clientSecret?e.jsx(C,{}):e.jsx(E,{})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Refresh Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.refreshToken?"text":"password",...c("refreshToken",{required:t==="outlook"&&"Refresh Token is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"M.xxxx"}),e.jsx("button",{type:"button",onClick:()=>B("refreshToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.refreshToken?e.jsx(C,{}):e.jsx(E,{})})]})]})]}),t==="smtp"&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(X,{}),e.jsx("span",{children:"Use any SMTP server (AWS SES, SendGrid, Mailgun, etc.)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["SMTP Host ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("host",{required:t==="smtp"&&"Host is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"smtp.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),e.jsx("input",{type:"number",...c("port"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"587"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...c("user",{required:t==="smtp"&&"Username is required"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"your-smtp-user"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.password?"text":"password",...c("password",{required:t==="smtp"&&"Password is required"}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"your-smtp-password"}),e.jsx("button",{type:"button",onClick:()=>B("password"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.password?e.jsx(C,{}):e.jsx(E,{})})]})]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...c("secure"),className:"w-4 h-4 text-sky-500 rounded focus:ring-sky-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Use TLS/SSL (port 465)"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:xe,disabled:j||!(a!=null&&a.configured),className:"flex items-center gap-2 px-4 py-2 text-sky-600 bg-sky-50 rounded-lg hover:bg-sky-100 disabled:opacity-50 disabled:cursor-not-allowed",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-sky-500 border-t-transparent rounded-full animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{})," Send Test Email"]})}),e.jsx("button",{type:"submit",disabled:v.isPending,className:"flex items-center gap-2 px-6 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50",children:v.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{})," Save Configuration"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"OTP Email Template"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Customize the HTML template used for email OTPs. Use ",e.jsx("span",{className:"font-mono",children:"{{code}}"})," and ",e.jsx("span",{className:"font-mono",children:"{{expiryMinutes}}"})," as placeholders."]})]})}),e.jsx("div",{className:"mt-4",children:e.jsx("textarea",{value:L,onChange:r=>l(r.target.value),className:"w-full h-48 p-3 border border-gray-200 rounded-lg font-sans",placeholder:"<p>Your OTP is <strong>{{code}}</strong></p>"})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{type:"button",onClick:H,disabled:O==null?void 0:O.isLoading,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-sky-600 text-white rounded-lg hover:bg-sky-700 disabled:opacity-50",children:[e.jsx(G,{})," ",O!=null&&O.isLoading?"Saving...":"Save Template"]})})]}),(h==null?void 0:h.length)>0&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium",children:"Available placeholders:"}),e.jsx("ul",{className:"list-disc list-inside",children:h.map(r=>e.jsx("li",{className:"font-mono",children:r},r))})]})]})}function we(o){return Qe({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 0C5.381-.008.008 5.352 0 11.971V12c0 6.64 5.359 12 12 12 6.64 0 12-5.36 12-12 0-6.641-5.36-12-12-12zm0 20.801c-4.846.015-8.786-3.904-8.801-8.75V12c-.014-4.846 3.904-8.786 8.75-8.801H12c4.847-.014 8.786 3.904 8.801 8.75V12c.015 4.847-3.904 8.786-8.75 8.801H12zm5.44-11.76c0 1.359-1.12 2.479-2.481 2.479-1.366-.007-2.472-1.113-2.479-2.479 0-1.361 1.12-2.481 2.479-2.481 1.361 0 2.481 1.12 2.481 2.481zm0 5.919c0 1.36-1.12 2.48-2.481 2.48-1.367-.008-2.473-1.114-2.479-2.48 0-1.359 1.12-2.479 2.479-2.479 1.361-.001 2.481 1.12 2.481 2.479zm-5.919 0c0 1.36-1.12 2.48-2.479 2.48-1.368-.007-2.475-1.113-2.481-2.48 0-1.359 1.12-2.479 2.481-2.479 1.358-.001 2.479 1.12 2.479 2.479zm0-5.919c0 1.359-1.12 2.479-2.479 2.479-1.367-.007-2.475-1.112-2.481-2.479 0-1.361 1.12-2.481 2.481-2.481 1.358 0 2.479 1.12 2.479 2.481z"},child:[]}]})(o)}const ls=[{id:"manual",name:"Manual (wa.me links)",icon:te,color:"text-green-500",description:"Opens WhatsApp Web for staff to send manually",recommended:!0},{id:"twilio",name:"Twilio WhatsApp",icon:we,color:"text-red-500",description:"Automated sending via Twilio API"},{id:"whatsapp-business",name:"WhatsApp Business API",icon:ve,color:"text-green-600",description:"Official WhatsApp Business Cloud API"}];function os(){const o=se(),[t,f]=g.useState("manual"),[p,F]=g.useState({}),[j,y]=g.useState(!1),{register:c,handleSubmit:q,reset:I,setValue:m,watch:N,formState:{errors:n}}=Q({defaultValues:{provider:"manual",clinicWhatsAppNumber:"",clinicWhatsAppName:"",twilioAccountSid:"",twilioAuthToken:"",twilioWhatsAppNumber:"",wabAccessToken:"",wabPhoneNumberId:"",wabBusinessId:""}});N("provider");const{data:a,isLoading:P}=R({queryKey:["whatsappConfig"],queryFn:()=>_.getWhatsAppConfig()});g.useEffect(()=>{a!=null&&a.configured&&(f(a.provider),m("provider",a.provider),m("clinicWhatsAppNumber",a.clinicWhatsAppNumber||""),m("clinicWhatsAppName",a.clinicWhatsAppName||""))},[a,m]);const v=T({mutationFn:_.saveWhatsAppConfig,onSuccess:()=>{x.success("WhatsApp configuration saved successfully"),o.invalidateQueries(["whatsappConfig"])},onError:l=>{var h,k;x.error(((k=(h=l.response)==null?void 0:h.data)==null?void 0:k.message)||"Failed to save configuration")}}),b=T({mutationFn:_.testWhatsAppConfig,onSuccess:l=>{l.url?(window.open(l.url,"_blank"),x.success("WhatsApp Web opened. Send the test message to verify.")):x.success(l.message||"Test message sent successfully")},onError:l=>{var h,k;x.error(((k=(h=l.response)==null?void 0:h.data)==null?void 0:k.message)||"Failed to send test message")}}),S=l=>{const h={provider:t,clinicWhatsAppNumber:l.clinicWhatsAppNumber,clinicWhatsAppName:l.clinicWhatsAppName};t==="twilio"?(h.twilioAccountSid=l.twilioAccountSid,h.twilioAuthToken=l.twilioAuthToken,h.twilioWhatsAppNumber=l.twilioWhatsAppNumber):t==="whatsapp-business"&&(h.wabAccessToken=l.wabAccessToken,h.wabPhoneNumberId=l.wabPhoneNumberId,h.wabBusinessId=l.wabBusinessId),v.mutate(h)},W=()=>{y(!0),b.mutate(void 0,{onSettled:()=>y(!1)})},L=l=>{F(h=>({...h,[l]:!h[l]}))};return P?e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"WhatsApp Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Configure WhatsApp messaging for your clinic"})]}),e.jsx("div",{className:"flex items-center gap-2",children:a!=null&&a.configured?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm",children:[e.jsx(je,{}),"Configured"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-sm",children:[e.jsx(Ue,{}),"Not Configured"]})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(X,{className:"text-blue-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Multi-Clinic WhatsApp Setup"}),e.jsx("p",{children:"Each clinic can have its own WhatsApp number. Messages will appear to patients as coming from your clinic's WhatsApp account."}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-blue-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Manual:"})," Staff sends from clinic's phone with pre-filled message"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Twilio:"})," Automated sending from your Twilio WhatsApp number"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Business API:"})," Official WhatsApp Business for verified business accounts"]})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Provider"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:ls.map(l=>{const h=l.icon;return e.jsxs("button",{type:"button",onClick:()=>{f(l.id),m("provider",l.id)},className:`relative p-4 border-2 rounded-xl text-left transition-all ${t===l.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[l.recommended&&e.jsx("span",{className:"absolute top-2 right-2 text-xs bg-green-500 text-white px-2 py-0.5 rounded-full",children:"Recommended"}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(h,{className:`text-2xl ${l.color}`}),e.jsx("span",{className:"font-medium text-gray-900",children:l.name})]}),e.jsx("p",{className:"text-xs text-gray-500",children:l.description})]},l.id)})})]}),e.jsxs("form",{onSubmit:q(S),className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(te,{className:"text-green-500"}),"Clinic WhatsApp Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic WhatsApp Number *"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"tel",...c("clinicWhatsAppNumber",{required:"Phone number is required"}),placeholder:"+91 9876543210",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),n.clinicWhatsAppNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.clinicWhatsAppNumber.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This is the phone number patients will see as the sender"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Name (as shown in WhatsApp)"}),e.jsx("input",{type:"text",...c("clinicWhatsAppName"),placeholder:"City Health Clinic",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your WhatsApp Business profile name"})]})]})]}),t==="twilio"&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(we,{className:"text-red-500"}),"Twilio Configuration"]}),e.jsxs("a",{href:"https://console.twilio.com",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-red-600 hover:underline flex items-center gap-1",children:["Get credentials ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account SID *"}),e.jsx("input",{type:"text",...c("twilioAccountSid",{required:t==="twilio"?"Account SID is required":!1}),placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auth Token *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.twilioAuthToken?"text":"password",...c("twilioAuthToken",{required:t==="twilio"?"Auth Token is required":!1}),placeholder:"Your Auth Token",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("button",{type:"button",onClick:()=>L("twilioAuthToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.twilioAuthToken?e.jsx(C,{}):e.jsx(E,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Twilio WhatsApp Number *"}),e.jsx("input",{type:"text",...c("twilioWhatsAppNumber",{required:t==="twilio"?"WhatsApp number is required":!1}),placeholder:"+14155238886",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Twilio sandbox number or your registered WhatsApp number"})]})]})]}),t==="whatsapp-business"&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(ve,{className:"text-green-600"}),"WhatsApp Business API Configuration"]}),e.jsxs("a",{href:"https://developers.facebook.com/docs/whatsapp/cloud-api/get-started",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-600 hover:underline flex items-center gap-1",children:["Setup Guide ",e.jsx(Z,{className:"text-xs"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," WhatsApp Business API requires a verified Facebook Business account and approved WhatsApp Business phone number."]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Access Token *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p.wabAccessToken?"text":"password",...c("wabAccessToken",{required:t==="whatsapp-business"?"Access Token is required":!1}),placeholder:"Your permanent access token",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("button",{type:"button",onClick:()=>L("wabAccessToken"),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p.wabAccessToken?e.jsx(C,{}):e.jsx(E,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number ID *"}),e.jsx("input",{type:"text",...c("wabPhoneNumberId",{required:t==="whatsapp-business"?"Phone Number ID is required":!1}),placeholder:"1234567890123456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Business Account ID"}),e.jsx("input",{type:"text",...c("wabBusinessId"),placeholder:"1234567890123456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]})]}),t==="manual"&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-green-900 flex items-center gap-2 mb-2",children:[e.jsx(te,{className:"text-green-500"}),"How Manual Mode Works"]}),e.jsxs("ol",{className:"text-sm text-green-800 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:'When you click "Send via WhatsApp", a new tab opens with WhatsApp Web'}),e.jsx("li",{children:"The message is pre-filled with prescription/appointment details"}),e.jsx("li",{children:'Staff clicks "Send" in WhatsApp Web to complete sending'}),e.jsx("li",{children:"The message appears to come from your clinic's WhatsApp account (the one logged into WhatsApp Web)"})]}),e.jsxs("p",{className:"text-sm text-green-700 mt-3",children:[e.jsx("strong",{children:"Tip:"})," Keep WhatsApp Web logged in on the clinic's computer with the clinic's WhatsApp Business account."]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:W,disabled:j||!(a!=null&&a.configured),className:"inline-flex items-center gap-2 px-4 py-2 text-green-600 bg-green-50 rounded-lg hover:bg-green-100 transition disabled:opacity-50",children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"○"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{}),"Send Test Message"]})}),e.jsx("button",{type:"submit",disabled:v.isPending,className:"inline-flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:v.isPending?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"○"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{}),"Save Configuration"]})})]})]})]})}const fe=["DOCTOR","RECEPTIONIST","PHARMACIST","ACCOUNTANT","STAFF","PATIENT"],me=["dashboard:view","patients:read","patients:create","patients:update","appointments:read","appointments:create","appointments:update","prescriptions:read","prescriptions:create","staff:read","staff:create","staff:update","pharmacy:read","pharmacy:create","billing:read","billing:create","billing:edit","reports:opd","purchases:read","purchases:create","ledger:read","ledger:create","ledger:update","ledger:delete"];me.push("leaves:read","leaves:create","leaves:update");const ds=["labs:read","labs:create","labs:update","labs:tests"],cs=["agents:read","agents:create","agents:update","commissions:read","commissions:pay"];function ms(){const o=se(),{data:t,isLoading:f,isError:p,error:F,refetch:j}=R({queryKey:["rolePermissions"],queryFn:()=>w.getRolePermissions()}),[y,c]=g.useState(null);g.useEffect(()=>{if(t!=null&&t.data)c(t.data);else if(!f&&!p){const n={};fe.forEach(a=>{n[a]=me.slice()}),c(n)}},[t,f,p]);const q=T({mutationFn:w.updateRolePermissions,onSuccess:()=>{o.invalidateQueries({queryKey:["rolePermissions"]}),x.success("Role permissions updated")},onError:n=>{var a,P;x.error(((P=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:P.message)||"Failed to update role permissions")}}),I={"patients:create":["patients:read"],"patients:update":["patients:read"],"appointments:create":["appointments:read"],"appointments:update":["appointments:read"],"prescriptions:create":["prescriptions:read"],"billing:create":["billing:read"],"billing:edit":["billing:read"],"pharmacy:create":["pharmacy:read"],"staff:create":["staff:read"],"staff:update":["staff:read"],"labs:manage":["labs:read"],"labs:create":["labs:read"],"labs:update":["labs:read"],"labs:tests":["labs:read"],"agents:manage":["agents:read"],"agents:create":["agents:read"],"agents:update":["agents:read"],"commissions:pay":["commissions:read"],"ledger:create":["ledger:read"],"ledger:update":["ledger:read"],"ledger:delete":["ledger:read"],"leaves:create":["leaves:read"],"leaves:update":["leaves:read"]},m=Object.keys(I).reduce((n,a)=>(I[a].forEach(P=>{n[P]=n[P]||[],n[P].push(a)}),n),{}),N=(n,a)=>{c(P=>{const v=new Set(P[n]||[]);if(v.has(a)){v.delete(a);const b=[a];for(;b.length;){const S=b.shift(),W=m[S]||[];for(const L of W)v.has(L)&&(v.delete(L),b.push(L))}}else{v.add(a);const b=I[a]||[];for(const S of b)v.add(S)}return{...P,[n]:Array.from(v)}})};return f?e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Role-based Feature Access"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]}):p?e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Role-based Feature Access"}),e.jsxs("p",{className:"text-sm text-red-500 mb-4",children:["Failed to load role permissions: ",(F==null?void 0:F.message)||"Unknown error"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ee,{variant:"secondary",onClick:()=>j(),children:"Retry"}),e.jsx(ee,{variant:"ghost",onClick:()=>{alert("If this persists, ensure the backend migration/role-permissions endpoint is applied and the server is running.")},children:"Help"})]})]}):y?e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Role-based Feature Access"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Grant or revoke feature access per role. Changes affect only this clinic."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:fe.map(n=>e.jsxs("div",{className:"p-4 border rounded",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("strong",{children:n})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"General"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:me.map(a=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(y[n]||[]).includes(a),onChange:()=>N(n,a)}),e.jsx("span",{className:"text-sm",children:a})]},a))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Labs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ds.map(a=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(y[n]||[]).includes(a),onChange:()=>N(n,a)}),e.jsx("span",{className:"text-sm",children:a})]},a))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Agents & Commissions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:cs.map(a=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-2 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(y[n]||[]).includes(a),onChange:()=>N(n,a)}),e.jsx("span",{className:"text-sm",children:a})]},a))})]})]},n))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(ee,{variant:"primary",onClick:()=>q.mutate(y),loading:q.isLoading,children:"Save Role Permissions"})})]}):null}const us=["appointments:read","prescriptions:read","billing:read","pharmacy:read"];function xs(){const o=se(),{data:t,isLoading:f,isError:p,refetch:F}=R({queryKey:["rolePermissions"],queryFn:()=>w.getRolePermissions()}),[j,y]=g.useState([]);g.useEffect(()=>{t&&t.data&&t.data.PATIENT?y(Array.isArray(t.data.PATIENT)?t.data.PATIENT:[]):!f&&!p&&y([])},[t,f,p]);const c=T({mutationFn:m=>w.updateRolePermissions(m),onSuccess:()=>{o.invalidateQueries({queryKey:["rolePermissions"]}),x.success("Mobile access updated")},onError:m=>{var N,n;x.error(((n=(N=m==null?void 0:m.response)==null?void 0:N.data)==null?void 0:n.message)||"Failed to update mobile access")}}),q=m=>{y(N=>{const n=new Set(N||[]);return n.has(m)?n.delete(m):n.add(m),Array.from(n)})},I=()=>{const m=t&&t.data?{...t.data}:{};m.PATIENT=j,c.mutate(m)};return f?e.jsx("div",{className:"p-4",children:"Loading mobile access..."}):p?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-red-600",children:"Failed to load mobile access settings."}),e.jsx("div",{className:"mt-2",children:e.jsx(ee,{variant:"ghost",onClick:()=>F(),children:"Retry"})})]}):e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-100",children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Mobile App"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Grant mobile (patient) access to select features."}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:us.map(m=>e.jsxs("label",{className:"inline-flex items-center space-x-2 bg-gray-50 px-3 py-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:(j||[]).includes(m),onChange:()=>q(m)}),e.jsx("span",{className:"text-sm",children:m})]},m))}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ee,{variant:"primary",onClick:I,loading:c.isLoading,children:"Save Mobile Access"})})]})}const ps=[{id:"profile",label:"Profile",icon:he},{id:"clinic",label:"Clinic",icon:Je},{id:"consultation",label:"Consultation Fees",icon:Xe},{id:"tax",label:"Tax Setup",icon:Ze},{id:"print",label:"Print Templates",icon:es},{id:"email",label:"Email",icon:ye},{id:"whatsapp",label:"WhatsApp",icon:te},{id:"preferences",label:"Preferences",icon:ss},{id:"access",label:"Access Management",icon:he}],gs=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],hs=[{id:"todayAppointments",label:"Today's Appointments",enabled:!0},{id:"revenue",label:"Revenue Stats",enabled:!0},{id:"recentPatients",label:"Recent Patients",enabled:!0},{id:"lowStock",label:"Low Stock Alerts",enabled:!0},{id:"pendingBills",label:"Pending Bills",enabled:!0},{id:"upcomingFollowups",label:"Upcoming Follow-ups",enabled:!1}];function Ns(){const o=se(),{user:t,loadUser:f}=Ye(),[p,F]=g.useState("profile"),[j,y]=g.useState(!1),[c,q]=g.useState(!1),{register:I,handleSubmit:m,formState:{errors:N}}=Q({defaultValues:{name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||""}}),{register:n,handleSubmit:a,reset:P,watch:v,formState:{errors:b}}=Q(),S=v("newPassword"),{register:W,handleSubmit:L,setValue:l,formState:{errors:h}}=Q(),{register:k,handleSubmit:O,setValue:H}=Q(),[ue,xe]=g.useState(gs.map(s=>({day:s,isOpen:s!=="Sunday",openTime:"09:00",closeTime:"18:00",breakStart:"13:00",breakEnd:"14:00"}))),[B,r]=g.useState(hs),[u,M]=g.useState({}),[V,U]=g.useState(ce({})),{data:D,isLoading:Se}=R({queryKey:["clinic-settings"],queryFn:()=>w.getClinicSettings()});g.useEffect(()=>{D&&(l("clinicName",D.clinicName||""),l("address",D.address||""),l("phone",D.phone||""),l("email",D.email||""),l("website",D.website||""),l("registrationNo",D.registrationNo||""),l("gstNo",D.gstNo||""))},[D,l]);const{data:z,isLoading:Pe}=R({queryKey:["tax-settings"],queryFn:()=>w.getTaxSettings()});g.useEffect(()=>{z&&(H("consultationGST",z.consultationGST||""),H("pharmacyGST",z.pharmacyGST||""),H("labGST",z.labGST||""),H("otherGST",z.otherGST||""),H("inclusiveTax",z.inclusiveTax||!1))},[z,H]);const{data:$,isLoading:Te}=R({queryKey:["preferences"],queryFn:()=>w.getPreferences()});g.useEffect(()=>{$!=null&&$.dashboardWidgets&&r($.dashboardWidgets)},[$]);const{data:K,isLoading:ke}=R({queryKey:["consultation-fees"],queryFn:()=>w.getConsultationFees()});g.useEffect(()=>{var i;const s=((i=K==null?void 0:K.data)==null?void 0:i.fees)||{};M(s)},[K]);const{data:ae,isLoading:Ae}=R({queryKey:["print-templates"],queryFn:()=>w.getPrintTemplates()});g.useEffect(()=>{ae&&U(ce(ae))},[ae]);const re=T({mutationFn:s=>w.updateProfile(s),onSuccess:async()=>{x.success("Profile updated successfully"),o.invalidateQueries(["user"]),await f()},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update profile")}}),Y=T({mutationFn:s=>w.changePassword(s),onSuccess:()=>{x.success("Password changed successfully"),P()},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to change password")}}),ne=T({mutationFn:s=>w.updateClinicSettings(s),onSuccess:()=>{x.success("Clinic settings updated successfully"),o.invalidateQueries(["clinic-settings"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update clinic settings")}}),ie=T({mutationFn:s=>w.updateTaxSettings(s),onSuccess:()=>{x.success("Tax settings updated successfully"),o.invalidateQueries(["tax-settings"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update tax settings")}});T({mutationFn:s=>w.updateWorkingHours(s),onSuccess:()=>{x.success("Working hours updated successfully"),o.invalidateQueries(["working-hours"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update working hours")}});const le=T({mutationFn:s=>w.updatePreferences(s),onSuccess:()=>{x.success("Preferences updated successfully"),o.invalidateQueries(["preferences"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update preferences")}}),oe=T({mutationFn:s=>w.updateConsultationFees(s),onSuccess:()=>{x.success("Consultation fees updated successfully"),o.invalidateQueries(["consultation-fees"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update consultation fees")}}),de=T({mutationFn:s=>w.updatePrintTemplates(s),onSuccess:()=>{x.success("Print templates updated successfully"),o.invalidateQueries(["print-templates"])},onError:s=>{var i,d;x.error(((d=(i=s.response)==null?void 0:i.data)==null?void 0:d.message)||"Failed to update print templates")}}),Ce=s=>{re.mutate(s)},pe=s=>{Y.mutate({currentPassword:s.currentPassword,newPassword:s.newPassword})},Ee=s=>{ne.mutate(s)},Fe=s=>{ie.mutate({...s,consultationGST:parseFloat(s.consultationGST)||0,pharmacyGST:parseFloat(s.pharmacyGST)||0,labGST:parseFloat(s.labGST)||0,otherGST:parseFloat(s.otherGST)||0})},qe=s=>{r(i=>i.map(d=>d.id===s?{...d,enabled:!d.enabled}:d))},Ie=()=>{le.mutate({dashboardWidgets:B})},We=(s,i)=>{M(d=>({...d,[s]:i===""?"":Math.max(0,Number(i))}))},Le=()=>{const s={};Object.entries(u||{}).forEach(([i,d])=>{const J=Number(d);Number.isFinite(J)&&J>=0&&(s[i]=J)}),oe.mutate(s)},Me=()=>{const s=ce(V);de.mutate(s)},ge=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Profile Information"}),e.jsxs("form",{onSubmit:m(Ce),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...I("name",{required:"Name is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),N.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:N.name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",...I("email",{required:"Email is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),N.email&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:N.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...I("phone"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:re.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),re.isPending?"Saving...":"Save Changes"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:a(pe),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:j?"text":"password",...n("currentPassword",{required:"Current password is required"}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>y(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:j?e.jsx(C,{}):e.jsx(E,{})})]}),b.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.currentPassword.message})]}),e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",...n("newPassword",{required:"New password is required",minLength:{value:8,message:"Password must be at least 8 characters"}}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>q(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(C,{}):e.jsx(E,{})})]}),b.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.newPassword.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",...n("confirmPassword",{required:"Please confirm your password",validate:s=>s===S||"Passwords do not match"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),b.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.confirmPassword.message})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:Y.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),Y.isPending?"Changing...":"Change Password"]})})]})]})]});if((t==null?void 0:t.role)==="STAFF")return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Settings"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:a(pe),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:j?"text":"password",...n("currentPassword",{required:"Current password is required"}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>y(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:j?e.jsx(C,{}):e.jsx(E,{})})]}),b.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.currentPassword.message})]}),e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",...n("newPassword",{required:"New password is required",minLength:{value:8,message:"Password must be at least 8 characters"}}),className:"w-full px-4 py-2.5 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>q(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(C,{}):e.jsx(E,{})})]}),b.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.newPassword.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",...n("confirmPassword",{required:"Please confirm your password",validate:s=>s===S||"Passwords do not match"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),b.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.confirmPassword.message})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:Y.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),Y.isPending?"Changing...":"Change Password"]})})]})]})]})});const Ge=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Clinic Information"}),Se?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("form",{onSubmit:L(Ee),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Clinic Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...W("clinicName",{required:"Clinic name is required"}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter clinic name"}),h.clinicName&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:h.clinicName.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{...W("address"),rows:2,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter full address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",...W("phone"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",...W("email"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),e.jsx("input",{type:"url",...W("website"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://www.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Registration Number"}),e.jsx("input",{type:"text",...W("registrationNo"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter registration number"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:ne.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),ne.isPending?"Saving...":"Save Changes"]})})]})]}),Re=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tax Configuration"}),Pe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("form",{onSubmit:O(Fe),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consultation GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...k("consultationGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pharmacy GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...k("pharmacyGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lab GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...k("labGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other GST (%)"}),e.jsx("input",{type:"number",step:"0.01",...k("otherGST"),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...k("inclusiveTax"),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Prices are inclusive of tax (Tax will be calculated from the total price)"})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{type:"submit",disabled:ie.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),ie.isPending?"Saving...":"Save Changes"]})})]})]}),Oe=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Dashboard Customization"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Choose which widgets to display on your dashboard"}),Te?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B.map(s=>e.jsx("div",{onClick:()=>qe(s.id),className:`p-4 border rounded-lg cursor-pointer transition ${s.enabled?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-medium ${s.enabled?"text-blue-700":"text-gray-700"}`,children:s.label}),e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${s.enabled?"bg-blue-600":"bg-gray-200"}`,children:s.enabled&&e.jsx(ts,{className:"text-white text-xs"})})]})},s.id))}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:Ie,disabled:le.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),le.isPending?"Saving...":"Save Preferences"]})})]})]}),Be=()=>{var i;const s=((i=K==null?void 0:K.data)==null?void 0:i.doctors)||[];return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Doctor Consultation Fees"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Set consultation amount per doctor. These values are used in new bills and auto-bill from prescription."}),ke?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No doctors found in this clinic."}):e.jsxs("div",{className:"space-y-3",children:[s.map(d=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-center border border-gray-100 rounded-lg p-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"font-medium text-gray-900",children:d.name}),d.email&&e.jsx("p",{className:"text-xs text-gray-500",children:d.email})]}),e.jsx("div",{children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:(u==null?void 0:u[d.id])??"",onChange:J=>We(d.id,J.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"})})]},d.id)),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:Le,disabled:oe.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),oe.isPending?"Saving...":"Save Consultation Fees"]})})]})]})},De=()=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Print Templates"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Choose a design for Bill and Prescription print. You can also use custom HTML with placeholders."}),Ae?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bill Template"}),e.jsx("select",{value:V.billTemplateId,onChange:s=>U(i=>({...i,billTemplateId:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:as.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prescription Template"}),e.jsx("select",{value:V.prescriptionTemplateId,onChange:s=>U(i=>({...i,prescriptionTemplateId:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:rs.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),V.billTemplateId==="custom"&&e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Bill HTML"}),e.jsx("textarea",{rows:10,value:V.customBillHtml,onChange:s=>U(i=>({...i,customBillHtml:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"<h1>{{clinicName}}</h1><div>Bill {{billNo}}</div><table>{{itemsTableRows}}</table>"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Bill placeholders: ",be.bill.join(", ")]})]}),V.prescriptionTemplateId==="custom"&&e.jsxs("div",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Prescription HTML"}),e.jsx("textarea",{rows:10,value:V.customPrescriptionHtml,onChange:s=>U(i=>({...i,customPrescriptionHtml:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"<h1>{{clinicName}}</h1><div>Prescription {{prescriptionNo}}</div><table>{{medicinesTableRows}}</table>"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Prescription placeholders: ",be.prescription.join(", ")]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Me,disabled:de.isPending,className:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:[e.jsx(G,{}),de.isPending?"Saving...":"Save Print Templates"]})})]})]}),He=()=>{switch(p){case"profile":return ge();case"clinic":return Ge();case"consultation":return Be();case"tax":return Re();case"print":return De();case"hours":return renderHoursTab();case"email":return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx(is,{})});case"whatsapp":return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx(os,{})});case"preferences":return Oe();case"access":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx(ms,{})}),e.jsx("div",{children:e.jsx(xs,{})})]});default:return ge()}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage your account and clinic settings"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:"lg:w-64 flex-shrink-0",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:ps.map(s=>e.jsxs("button",{onClick:()=>F(s.id),className:`w-full flex items-center gap-3 px-4 py-3 text-left transition ${p===s.id?"bg-blue-50 text-blue-600 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-50 border-l-4 border-transparent"}`,children:[e.jsx(s.icon,{className:p===s.id?"text-blue-600":"text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.label})]},s.id))})}),e.jsx("div",{className:"flex-1",children:He()})]})]})})}export{Ns as default};
